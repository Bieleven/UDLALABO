create or replace FUNCTION FN_LISTARRECURASIGNADO (VARtipo IN VARCHAR2 )
return sys_refcursor as datos sys_refcursor;
BEGIN
 open datos for
select udlalabo3.vs_recursofisico.REFI_ID ID, udlalabo3.vs_recursofisico.REFI_NOMENCLATURA NOMBRE, udlalabo3.vs_recursofisico.REFI_CAPACIDAD CAPACIDAD,
UDLALABO3.VS_LOCALIDAD.LOCA_NOMBRE SEDE, UDLALABO3.VS_TIPORECURSO.TIPO_NOMBRE TIPOR from UDLALABO3.asignacionrecurso
INNER JOIN udlalabo3.vs_recursofisico ON
vs_recursofisico.refi_id=asignacionrecurso.refi_id
INNER JOIN UDLALABO3.VS_LOCALIDAD ON
UDLALABO3.VS_LOCALIDAD.LOCA_ID = udlalabo3.vs_recursofisico.loca_id
INNER JOIN UDLALABO3.vs_tiporecurso ON
UDLALABO3.VS_TIPORECURSO.TIPO_ID= UDLALABO3.VS_RECURSOFISICO.TIPO_ID
where UDLALABO3.VS_RECURSOFISICO.tipo_id=VARtipo;
RETURN DATOS;
EXCEPTION 
WHEN OTHERS THEN
RAISE_APPLICATION_ERROR(-20001,'Se ha encontrado un error en la ejecuciÂ¿n de la consulta.');
RAISE;
END FN_LISTARRECURASIGNADO;
